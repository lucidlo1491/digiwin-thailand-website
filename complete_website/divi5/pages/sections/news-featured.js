/**
 * news-featured.js — Featured Section (S2)
 *
 * AUTO-GENERATED by scaffold-builder.js — review and customize before pushing.
 * Source: news.html line 1280
 *
// NOTE: Contains inline SVGs — may need Base64 JS injection if wp_kses strips elements.
 * styles.css: 11 base, 0 hover, 0 pseudo, 0 hidden
 * Original classes: featured-section, fade-in-section, featured-inner, featured-label, featured-card (+15 more)
 */

// TEMPLATE HINT: matches "card-grid-dark". See home-trust-anchors.js for example.
const base = require('../../lib/templates/_base');

const P = 'fea'; // CSS prefix — customize if needed

// ════════════════════════════════════════════════════════════════
// BLOCKS
// ════════════════════════════════════════════════════════════════
function blocks() {
  const html = `
    <div class="particle-ocean-host" data-particles style="position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden;"></div>
            <div class="featured-inner" style="position: relative; z-index: 2;">
                <span class="featured-label">Featured Event</span>
                <div class="featured-card">
                    <div class="featured-image">
                        <div class="${P}">
                            <div class="${P}-month">Mar</div>
                            <div class="${P}-day">15</div>
                            <div class="${P}-year">2026</div>
                            <div class="${P}-divider"></div>
                        </div>
                        <div class="${P}-meta">
                            <div class="${P}-meta-item">
                                <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                                09:00 – 16:00
                            </div>
                            <div class="${P}-meta-item">
                                <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/></svg>
                                Bangkok, Thailand
                            </div>
                        </div>
                        <span class="urgency-badge">
                            <svg aria-hidden="true" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4-4v-2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
                            Limited to 30 Participants
                        </span>
                    </div>
                    <div class="featured-content">
                        <span class="event-type-badge workshop">Workshop</span>
                        <h2>BOI Compliance Workshop: Production-Level Reconciliation That Passes Every Audit</h2>
                        <div class="event-meta">
                            <div class="event-meta-item">
                                <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                                March 15, 2026 | 09:00 – 16:00
                            </div>
                            <div class="event-meta-item">
                                <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/></svg>
                                Bangkok, Thailand
                            </div>
                        </div>
                        <p>Learn how production-order-level material tracking eliminates BOI supplementary taxes. Featuring the Jin Hai case study: from 10M THB/year to zero.</p>
                        <a href="events/boi-compliance-workshop.html" class="event-cta">Register Now
                            <svg aria-hidden="true" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                        </a>
                    </div>
                </div>
            </div>
            <script>
(function(){
'use strict';
var rm=window.matchMedia('(prefers-reduced-motion: reduce)').matches;
var PI2=Math.PI*2;
var BLUE=[0,175,240],CYAN=[0,230,255];
var PRESET={frontOpacity:0.30,backOpacity:0.04,frontRadius:4.5,backRadius:0.6,color:BLUE,colorAlt:CYAN,altRatio:0.12};
function lerp(a,b,t){return a+(b-a)*t;}

function DataOcean(section){
this.el=section;this.canvas=null;this.ctx=null;this.w=0;this.h=0;
this.dpr=Math.min(window.devicePixelRatio||1,2);this.visible=false;this.raf=null;this.time=0;this.resizeTimer=null;this.colors=null;
this.opts=PRESET;this._setup();this._buildColors();this._observe();
if(!rm){this._loop();}else{this.visible=true;this._draw(0);}
}

DataOcean.prototype._setup=function(){
var c=document.createElement('canvas');c.setAttribute('aria-hidden','true');
c.style.cssText='position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:0;';
this.el.style.position='relative';
this.el.style.overflow='hidden';
this.el.insertBefore(c,this.el.firstChild);
this.canvas=c;this.ctx=c.getContext('2d');this._resize();
var self=this;window.addEventListener('resize',function(){clearTimeout(self.resizeTimer);self.resizeTimer=setTimeout(function(){self._resize();self._buildColors();},200);});
};

DataOcean.prototype._resize=function(){
/* Use clientHeight — the CSS box size, not scroll or content height */
this.w=this.el.clientWidth;this.h=this.el.clientHeight;
this.canvas.width=this.w*this.dpr;this.canvas.height=this.h*this.dpr;
this.ctx.setTransform(this.dpr,0,0,this.dpr,0,0);
};

DataOcean.prototype._buildColors=function(){var cols=Math.min(65,Math.ceil(this.w/22)+4);var rows=35;this._cols=cols;this._rows=rows;var n=cols*rows;this.colors=new Array(n);var alt=this.opts.altRatio;for(var i=0;i<n;i++){this.colors[i]=Math.random()<alt?this.opts.colorAlt:this.opts.color;}};
DataOcean.prototype._observe=function(){var self=this;if('IntersectionObserver' in window){this._obs=new IntersectionObserver(function(e){self.visible=e[0].isIntersecting;},{rootMargin:'150px 0px'});this._obs.observe(this.el);}else{this.visible=true;}};
DataOcean.prototype._loop=function(){var self=this;var last=0;(function tick(ts){self.raf=requestAnimationFrame(tick);if(!self.visible)return;if(ts-last<30)return;last=ts;self.time+=0.006;self._draw(self.time);})(0);};

DataOcean.prototype._draw=function(t){
var ctx=this.ctx,w=this.w,h=this.h,opts=this.opts,cols=this._cols,rows=this._rows;
ctx.clearRect(0,0,w,h);
var ground=h+10,horizon=h*0.35,totalSpan=ground-horizon,idx=0;
for(var row=rows-1;row>=0;row--){
var depth=row/(rows-1),mappedDepth=Math.pow(depth,0.55),baseY=ground-mappedDepth*totalSpan;
var dotR=lerp(opts.frontRadius,opts.backRadius,depth),dotA=lerp(opts.frontOpacity,opts.backOpacity,depth);
var colSpacing=lerp(w/(cols-4),w/(cols+15),depth),rowShift=depth*w*0.12;
var waveScale=(1-depth*0.75),amp1=70*waveScale,amp2=25*waveScale;
for(var col=0;col<cols;col++){
var screenX=col*colSpacing-rowShift+colSpacing*0.5;
if(screenX<-30||screenX>w+30){idx++;continue;}
var worldX=col*24,worldZ=row*18;
var wave=amp1*Math.sin(worldX*0.0065+worldZ*0.012+t*0.9);
wave+=amp2*Math.sin(worldX*0.013-worldZ*0.008+t*0.55+1.8);
var screenY=baseY-wave;if(screenY<-15||screenY>h+15){idx++;continue;}
var c=this.colors[idx%this.colors.length];
ctx.beginPath();ctx.arc(screenX,screenY,dotR,0,PI2);
ctx.fillStyle='rgba('+c[0]+','+c[1]+','+c[2]+','+dotA+')';ctx.fill();idx++;
}}};

/* Init: walk up from marker to .et_pb_section, insert canvas there */
function init(){
var marker=document.querySelector('.particle-ocean-host');
if(!marker)return;
var section=marker.closest('.et_pb_section');
if(!section){section=marker.closest('.featured-section');} /* HTML fallback */
if(!section)return;
marker.remove(); /* clean up — canvas goes on section */
new DataOcean(section);
}
/* Delay to ensure Divi CSS has loaded and section is properly sized */
if(document.readyState==='complete'){setTimeout(init,200);}
else{window.addEventListener('load',function(){setTimeout(init,200);});}
})();
            </script>`;

  return base.wrapInDiviSection('Featured', html, 'Featured: Content');
}

// ════════════════════════════════════════════════════════════════
// CSS
// ════════════════════════════════════════════════════════════════
function css() {
  return `
/* === FEATURED (S2) === */
/* Divi 5 section boilerplate (font-smoothing, p padding, heading resets) */
.${P}-section{position:relative;overflow:hidden;${base.fontSmoothingReset(P)}font-size:16px}
.${P}-section p{padding-bottom:0;line-height:1.6}
.${P}-section h2,.${P}-section h3,.${P}-section h4{margin:0;padding:0;line-height:1.6}
/* .featured-section padding/bg handled by section-level :has() overrides */
.featured-inner {
            max-width: 1200px;
            margin: 0 auto;
        }
.featured-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            font-weight: 500;
            color: #0369a1;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 24px;
            display: block;
        }
.featured-card {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
        }
.featured-card:hover {
            border-color: #00AFF0;
            box-shadow: 0 12px 40px rgba(0, 175, 240, 0.12);
        }
.featured-image {
            background: linear-gradient(165deg, #0f1419 0%, #1a2632 40%, #000864 100%);
            min-height: 380px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            padding: 48px 32px;
            gap: 24px;
        }
.featured-image::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            animation: grain 8s steps(10) infinite;
        }
.featured-image::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 50% 40%, rgba(0,175,240,0.1), transparent 60%);
            pointer-events: none;
        }
.fea {
            position: relative;
            z-index: 1;
            text-align: center;
        }
.fea-month {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 500;
            color: #0369a1;
            letter-spacing: 4px;
            text-transform: uppercase;
            margin-bottom: 4px;
        }
.fea-day {
            font-family: 'Noto Sans', sans-serif;
            font-size: 80px;
            font-weight: 700;
            color: #fff;
            line-height: 1;
            margin-bottom: 4px;
        }
.fea-year {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 400;
            color: rgba(255,255,255,0.75);
            letter-spacing: 3px;
            margin-bottom: 20px;
        }
.fea-divider {
            width: 48px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00AFF0, transparent);
            margin: 0 auto 20px;
        }
.fea-meta {
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
            z-index: 1;
        }
.fea-meta-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: rgba(255,255,255,0.75);
        }
.fea-meta-item svg {
            width: 15px;
            height: 15px;
            stroke: #00AFF0;
            fill: none;
            flex-shrink: 0;
        }
.urgency-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #b45309;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
            padding: 8px 16px;
            border-radius: 50px;
            position: relative;
            z-index: 1;
            margin-top: 4px;
        }
.featured-content {
            padding: 48px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
.event-type-badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 14px;
            border-radius: 50px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 16px;
            width: fit-content;
        }
.event-type-badge.seminar {
            background: rgba(0, 175, 240, 0.12);
            color: #0369a1;
        }
.event-type-badge.workshop {
            background: rgba(34, 197, 94, 0.12);
            color: #15803d;
        }
.event-type-badge.factory-visit {
            background: rgba(245, 158, 11, 0.12);
            color: #b45309;
        }
.event-type-badge.trade-show {
            background: rgba(139, 92, 246, 0.12);
            color: #7c3aed;
        }
.featured-content h2 {
            font-family: 'Noto Sans', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: #000864;
            line-height: 1.3;
            margin-bottom: 16px;
        }
.event-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }
.event-meta-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #5b6b80;
        }
.event-meta-item svg {
            width: 16px;
            height: 16px;
            stroke: #00AFF0;
            fill: none;
            flex-shrink: 0;
        }
.featured-content p {
            font-size: 15px;
            color: #5b6b80;
            line-height: 1.7;
            margin-bottom: 28px;
        }
.event-cta {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 32px;
            background: linear-gradient(135deg, #00AFF0, #003CC8);
            color: #fff;
            text-decoration: none;
            border-radius: 12px;
            font-family: 'Noto Sans', sans-serif;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: fit-content;
        }
.event-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 175, 240, 0.3);
        }
.upcoming-card-border.workshop { background: #22C55E; }
.upcoming-card-body .event-type-badge {
            margin-bottom: 16px;
        }
.upcoming-card-body .event-meta {
            margin-bottom: 16px;
        }
.past-card .event-type-badge {
            margin-bottom: 12px;
        }
.fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
.fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
@media (max-width: 1024px) {
.featured-card {
                grid-template-columns: 1fr;
            }
.featured-image {
                min-height: 240px;
                padding: 36px 24px;
            }
.fea-day {
                font-size: 64px;
            }
}
@media (max-width: 640px) {
.fea-day {
                font-size: 56px;
            }
.featured-content {
                padding: 28px;
            }
.featured-content h2 {
                font-size: 22px;
            }
}

/* REF: BASE RULES from styles.css (check against inline CSS above) */
/* .event-type-badge{display:inline-flex;align-items:center;padding:6px 14px;border-radius:50px;font-family:'JetBrains Mono', monospace;font-size:11px;font-weight:500;letter-spacing:1px;text-transform:uppercase;margin-bottom:16px;width:fit-content} */
/* .event-type-badge.seminar{background:rgba(0, 175, 240, 0.12);color:var(--dw-blue-text)} */
/* .event-type-badge.workshop{background:rgba(34, 197, 94, 0.12);color:#15803d} */
/* .event-type-badge.factory-visit{background:rgba(245, 158, 11, 0.12);color:#b45309} */
/* .event-type-badge.trade-show{background:rgba(139, 92, 246, 0.12);color:#7c3aed} */
/* .event-meta{display:flex;flex-direction:column;gap:8px;margin-bottom:20px} */
/* .event-meta-item{display:flex;align-items:center;gap:10px;font-family:'Noto Sans', sans-serif;font-size:14px;color:#5b6b80} */
/* .event-meta-item svg{width:16px;height:16px;stroke:var(--dw-blue-text);fill:none;flex-shrink:0} */
/* .upcoming-card-border.workshop{background:#22C55E} */
/* .upcoming-card-body .event-type-badge{margin-bottom:16px} */
/* .upcoming-card-body .event-meta{margin-bottom:16px} */


${base.reducedMotion('*{animation:none !important;transition:none !important}')}

.et_pb_section .fea-month {
            line-height: 25.6px !important;
        
            color: rgb(3, 105, 161);

            margin-bottom: 4px;

            -webkit-font-smoothing: auto !important;
}

.et_pb_section .fea-year {
            line-height: 22.4px !important;
        
            -webkit-font-smoothing: auto !important;
}

.et_pb_section .fea-meta-item {
            line-height: 20.8px !important;
        
            -webkit-font-smoothing: auto !important;
}

.et_pb_section .urgency-badge {
            line-height: 17.6px !important;
        
            -webkit-font-smoothing: auto !important;
}

.et_pb_section .event-type-badge {
            line-height: 17.6px !important;
        
            -webkit-font-smoothing: auto !important;
}

.et_pb_section .event-meta-item {
            line-height: 22.4px !important;
        
            -webkit-font-smoothing: auto !important;
}

.et_pb_section .event-cta {
            -webkit-font-smoothing: auto !important;
        }

.et_pb_section .fea-day {
            line-height: 80px !important;
        
            color: rgb(255, 255, 255);

            margin-bottom: 4px;

            -webkit-font-smoothing: auto !important;
}

/* Divi section-level overrides */
.et_pb_section:has(.featured-inner) {
  background: #fff !important;
  padding: 100px 24px !important;
  position: relative !important;
  overflow: hidden !important;
}

.et_pb_section:has(.featured-inner) .et_pb_row {
  max-width: 100% !important;
  width: 100% !important;
  padding: 0 !important;
  background: transparent !important;
  position: relative !important;
  z-index: 1 !important;
}

.et_pb_section:has(.featured-inner) .et_pb_column {
  padding: 0 !important;
  background: transparent !important;
}

.et_pb_section .featured-inner {
  width: 100% !important;
  -webkit-font-smoothing: auto !important;
}

.et_pb_section .featured-label {
  line-height: 19.2px !important;
}

.et_pb_section .featured-content h2 {
  font-size: 24px !important;
  line-height: 1.6 !important;
  color: rgb(51, 51, 51) !important;
  padding: 0 !important;
  margin: 0 !important;
  -webkit-font-smoothing: auto !important;
}

.et_pb_section .event-cta {
  line-height: 24px !important;
}

.et_pb_section .featured-card {
  display: grid !important;
  grid-template-columns: 1.2fr 1fr !important;
  border-radius: 20px !important;
  overflow: hidden !important;
  border: 1px solid #e2e8f0 !important;
  background: #fff !important;
  box-shadow: 0 4px 24px rgba(0,0,0,0.06) !important;
}

.et_pb_section .featured-image {
  background: linear-gradient(165deg, #0f1419 0%, #1a2632 40%, #000864 100%) !important;
  min-height: 380px !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  position: relative !important;
  overflow: hidden !important;
  padding: 48px 32px !important;
  gap: 24px !important;
}

.et_pb_section .featured-content {
  padding: 48px !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
}

.et_pb_section .featured-content p {
  padding-bottom: 0 !important;
  -webkit-font-smoothing: auto !important;
  font-size: 15px !important;
  color: #5b6b80 !important;
  line-height: 1.7 !important;
}

.et_pb_section .fea {
  text-align: center !important;
}

.et_pb_section .fea-month {
  font-family: 'JetBrains Mono', monospace !important;
  font-size: 16px !important;
  font-weight: 500 !important;
  color: #0369a1 !important;
  letter-spacing: 2px !important;
  text-transform: uppercase !important;
  margin-bottom: 4px !important;
}

.et_pb_section .fea-day {
  font-family: 'Noto Sans', sans-serif !important;
  font-size: 80px !important;
  font-weight: 700 !important;
  color: #fff !important;
  line-height: 1 !important;
  margin-bottom: 4px !important;
}

.et_pb_section .fea-year {
  font-family: 'JetBrains Mono', monospace !important;
  font-size: 14px !important;
  color: rgba(255,255,255,0.6) !important;
  letter-spacing: 3px !important;
}

.et_pb_section .fea-divider {
  width: 40px !important;
  height: 2px !important;
  background: rgba(255,255,255,0.3) !important;
  margin: 16px auto 0 !important;
}

.et_pb_section .fea-meta {
  display: flex !important;
  flex-direction: column !important;
  gap: 8px !important;
}

.et_pb_section .fea-meta-item {
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  color: rgba(255,255,255,0.75) !important;
  font-size: 13px !important;
}

.et_pb_section .fea-meta-item svg {
  width: 14px !important;
  height: 14px !important;
  stroke: rgba(255,255,255,0.6) !important;
  fill: none !important;
  flex-shrink: 0 !important;
}

.et_pb_section .urgency-badge {
  display: inline-flex !important;
  align-items: center !important;
  gap: 6px !important;
  background: rgba(245, 158, 11, 0.15) !important;
  border: 1px solid rgba(245, 158, 11, 0.3) !important;
  color: #b45309 !important;
  font-family: 'JetBrains Mono', monospace !important;
  font-size: 11px !important;
  padding: 8px 16px !important;
  border-radius: 50px !important;
}

.et_pb_section .event-cta {
  display: inline-flex !important;
  align-items: center !important;
  gap: 8px !important;
  background: linear-gradient(135deg, #00AFF0, #003CC8) !important;
  color: #fff !important;
  padding: 14px 28px !important;
  border-radius: 12px !important;
  font-weight: 600 !important;
  font-size: 15px !important;
  text-decoration: none !important;
  margin-top: auto !important;
  width: fit-content !important;
}

`.trim();
}

module.exports = { blocks, css };
